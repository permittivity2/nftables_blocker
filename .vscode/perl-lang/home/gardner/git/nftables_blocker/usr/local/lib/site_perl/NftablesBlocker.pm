{"version":5,"vars":[{"name":"strict","line":12,"containerName":"","kind":2},{"kind":2,"containerName":"","name":"warnings","line":13},{"name":"Any","line":14,"containerName":"Log","kind":2},{"containerName":"Log::Any","kind":2,"name":"Adapter","line":15},{"kind":2,"containerName":"Log::Log4perl","line":16,"name":"MDC"},{"line":17,"name":"Carp","containerName":"","kind":2},{"line":18,"name":"File","containerName":"Config","kind":2},{"line":19,"name":"DBI","kind":2,"containerName":""},{"name":"threads","line":20,"kind":2,"containerName":""},{"name":"Queue","line":21,"kind":2,"containerName":"Thread"},{"line":22,"name":"Load","containerName":"Module","kind":2},{"containerName":"","kind":2,"name":"POSIX","line":23},{"line":24,"name":"shared","kind":2,"containerName":"threads"},{"containerName":"Data","kind":2,"line":25,"name":"Dumper"},{"containerName":"","kind":2,"line":26,"name":"JSON"},{"kind":13,"containerName":null,"name":"$Data","line":28},{"containerName":"Indent","kind":12,"name":"Dumper","line":28},{"kind":13,"containerName":null,"name":"$Data","line":29},{"kind":12,"containerName":"Sortkeys","name":"Dumper","line":29},{"kind":13,"containerName":null,"definition":"my","localvar":"my","name":"$exit_flag","line":31},{"kind":12,"line":31,"name":"shared"},{"definition":"our","kind":13,"containerName":"main::","line":33,"name":"$running"},{"name":"$ip_block_queue","localvar":"my","line":35,"containerName":null,"kind":13,"definition":"my"},{"kind":12,"line":35,"name":"shared"},{"line":35,"name":"Thread","kind":12,"containerName":"Queue"},{"kind":12,"containerName":"main::","name":"new","line":35},{"line":37,"signature":{"parameters":[{"label":"$class"},{"label":"%args"}],"documentation":"","label":"new($class,%args)"},"definition":"sub","detail":"($class,%args)","range":{"start":{"character":0,"line":37},"end":{"character":9999,"line":77}},"name":"new","containerName":"main::","kind":12,"children":[{"localvar":"my","name":"$class","line":38,"containerName":"new","kind":13,"definition":"my"},{"line":38,"name":"%args","kind":13,"containerName":"new"},{"name":"put","line":39,"containerName":"new","kind":12},{"line":39,"name":"tid","kind":12,"containerName":"new"},{"line":40,"name":"put","kind":12,"containerName":"new"},{"line":41,"name":"$log","containerName":"new","kind":13},{"line":41,"name":"info","kind":12,"containerName":"new"},{"definition":"my","kind":13,"containerName":"new","line":42,"localvar":"my","name":"$self"},{"name":"$args","line":43,"containerName":"new","kind":13},{"containerName":"new","kind":13,"line":44,"name":"$args"},{"containerName":"new","kind":13,"name":"$args","line":45},{"line":46,"name":"$args","kind":13,"containerName":"new"},{"line":46,"name":"$log","kind":13,"containerName":"new"},{"containerName":"new","kind":12,"line":46,"name":"error"},{"kind":13,"containerName":"new","name":"$args","line":48},{"kind":13,"containerName":"new","line":49,"name":"$args"},{"line":50,"name":"$args","kind":13,"containerName":"new"},{"line":51,"name":"$args","containerName":"new","kind":13},{"name":"$args","line":52,"containerName":"new","kind":13},{"name":"$args","line":53,"containerName":"new","kind":13},{"kind":13,"containerName":"new","line":56,"name":"$log"},{"line":56,"name":"info","kind":12,"containerName":"new"},{"name":"$self","line":56,"containerName":"new","kind":13},{"line":57,"name":"$self","containerName":"new","kind":13},{"name":"$class","line":57,"kind":13,"containerName":"new"},{"name":"$self","line":60,"kind":13,"containerName":"new"},{"line":60,"name":"_check_nftables","containerName":"new","kind":12},{"kind":13,"containerName":"new","line":62,"name":"$self"},{"kind":12,"containerName":"new","name":"_check_nftables_setup","line":62},{"name":"$self","line":63,"containerName":"new","kind":13},{"line":63,"name":"_delete_nftables_chain","kind":12,"containerName":"new"},{"name":"$self","line":64,"kind":13,"containerName":"new"},{"line":64,"name":"_create_nftables_chain","kind":12,"containerName":"new"},{"name":"$log","line":67,"kind":13,"containerName":"new"},{"line":67,"name":"info","containerName":"new","kind":12},{"kind":13,"containerName":"new","name":"$self","line":71},{"name":"_load_config","line":71,"containerName":"new","kind":12},{"name":"$self","line":74,"kind":13,"containerName":"new"},{"containerName":"new","kind":12,"line":74,"name":"_setup_database"},{"containerName":"new","kind":13,"name":"$self","line":76}]},{"containerName":"Log4perl::MDC","kind":12,"name":"Log","line":39},{"name":"threads","line":39,"kind":12},{"containerName":"Log4perl::MDC","kind":12,"line":40,"name":"Log"},{"line":43,"name":"config_file","kind":12},{"name":"config_file","line":43,"kind":12},{"line":44,"name":"lock_file","kind":12},{"kind":12,"line":44,"name":"lock_file"},{"line":45,"name":"scan_interval","kind":12},{"kind":12,"line":45,"name":"scan_interval"},{"name":"db_file","line":46,"kind":12},{"kind":12,"line":46,"name":"db_file"},{"kind":12,"name":"croak","line":46},{"kind":12,"line":48,"name":"chain"},{"kind":12,"line":48,"name":"chain"},{"kind":12,"line":49,"name":"element"},{"name":"element","line":49,"kind":12},{"name":"table","line":50,"kind":12},{"name":"table","line":50,"kind":12},{"line":51,"name":"family","kind":12},{"line":51,"name":"family","kind":12},{"kind":12,"name":"timeout","line":52},{"line":52,"name":"timeout","kind":12},{"name":"module","line":53,"kind":12},{"kind":12,"line":53,"name":"module"},{"name":"configs","line":54,"kind":12},{"kind":12,"name":"Dumper","line":56},{"line":60,"name":"croak","kind":12},{"kind":12,"line":63,"name":"croak"},{"kind":12,"line":64,"name":"croak"},{"line":71,"name":"croak","kind":12},{"line":74,"name":"croak","kind":12},{"definition":"sub","children":[{"kind":13,"containerName":"_check_nftables","definition":"my","name":"$self","localvar":"my","line":80},{"name":"$nft_check","localvar":"my","line":81,"kind":13,"containerName":"_check_nftables","definition":"my"},{"line":83,"name":"$log","containerName":"_check_nftables","kind":13},{"kind":12,"containerName":"_check_nftables","name":"error","line":83},{"line":84,"name":"$log","containerName":"_check_nftables","kind":13},{"containerName":"_check_nftables","kind":12,"line":84,"name":"info"},{"containerName":"_check_nftables","kind":13,"name":"$log","line":85},{"kind":12,"containerName":"_check_nftables","name":"info","line":85},{"containerName":"_check_nftables","kind":13,"line":86,"name":"$log"},{"line":86,"name":"info","containerName":"_check_nftables","kind":12},{"line":87,"name":"$log","containerName":"_check_nftables","kind":13},{"containerName":"_check_nftables","kind":12,"line":87,"name":"info"},{"name":"$log","line":88,"kind":13,"containerName":"_check_nftables"},{"line":88,"name":"info","kind":12,"containerName":"_check_nftables"},{"kind":13,"containerName":"_check_nftables","name":"$log","line":91},{"kind":12,"containerName":"_check_nftables","name":"info","line":91}],"kind":12,"containerName":"main::","range":{"start":{"character":0,"line":79},"end":{"line":92,"character":9999}},"line":79,"name":"_check_nftables"},{"definition":"sub","children":[{"localvar":"my","name":"$self","line":95,"kind":13,"containerName":"_load_config","definition":"my"},{"containerName":"_load_config","kind":13,"line":96,"name":"$log"},{"line":96,"name":"info","kind":12,"containerName":"_load_config"},{"name":"$config","localvar":"my","line":97,"containerName":"_load_config","kind":13,"definition":"my"},{"containerName":"_load_config","kind":13,"line":97,"name":"$self"},{"kind":13,"containerName":"_load_config","name":"$config","line":98},{"kind":13,"containerName":"_load_config","line":99,"name":"$log"},{"name":"error","line":99,"containerName":"_load_config","kind":12},{"name":"$self","line":102,"containerName":"_load_config","kind":13},{"containerName":"_load_config","kind":13,"name":"$config","line":102},{"containerName":"_load_config","kind":13,"line":103,"name":"$log"},{"kind":12,"containerName":"_load_config","name":"info","line":103},{"line":107,"name":"$self","kind":13,"containerName":"_load_config"},{"line":107,"name":"$config","containerName":"_load_config","kind":13},{"kind":13,"containerName":"_load_config","line":107,"name":"$self"},{"line":108,"name":"$log","kind":13,"containerName":"_load_config"},{"kind":12,"containerName":"_load_config","line":108,"name":"info"},{"containerName":"_load_config","kind":13,"name":"$self","line":109},{"line":109,"name":"$config","containerName":"_load_config","kind":13},{"line":109,"name":"$self","containerName":"_load_config","kind":13},{"kind":13,"containerName":"_load_config","name":"$log","line":110},{"name":"info","line":110,"kind":12,"containerName":"_load_config"}],"kind":12,"containerName":"main::","range":{"end":{"line":113,"character":9999},"start":{"line":94,"character":0}},"line":94,"name":"_load_config"},{"kind":12,"name":"read_config_file","line":97},{"name":"config_file","line":97,"kind":12},{"kind":12,"line":102,"name":"configs"},{"kind":12,"name":"chain","line":107},{"kind":12,"line":107,"name":"chain"},{"kind":12,"line":107,"name":"chain"},{"kind":12,"name":"element","line":109},{"name":"element","line":109,"kind":12},{"line":109,"name":"element","kind":12},{"children":[{"name":"$self","localvar":"my","line":116,"kind":13,"containerName":"_setup_database","definition":"my"},{"name":"$db_file","localvar":"my","line":117,"containerName":"_setup_database","kind":13,"definition":"my"},{"kind":13,"containerName":"_setup_database","name":"$self","line":117},{"name":"$log","line":118,"containerName":"_setup_database","kind":13},{"line":118,"name":"info","kind":12,"containerName":"_setup_database"},{"definition":"my","kind":13,"containerName":"_setup_database","line":119,"name":"$dsn","localvar":"my"},{"localvar":"my","name":"$dbh","line":120,"kind":13,"containerName":"_setup_database","definition":"my"},{"kind":13,"containerName":"_setup_database","name":"$dsn","line":120},{"name":"$dbh","line":122,"containerName":"_setup_database","kind":13},{"line":123,"name":"$log","kind":13,"containerName":"_setup_database"},{"line":123,"name":"error","containerName":"_setup_database","kind":12},{"containerName":"_setup_database","kind":13,"name":"$dbh","line":129},{"kind":12,"containerName":"_setup_database","line":129,"name":"do"},{"name":"$dbh","line":135,"containerName":"_setup_database","kind":13},{"kind":12,"containerName":"_setup_database","line":135,"name":"do"},{"kind":13,"containerName":"_setup_database","line":141,"name":"$dbh"},{"name":"do","line":141,"kind":12,"containerName":"_setup_database"},{"kind":13,"containerName":"_setup_database","name":"$dbh","line":147},{"line":147,"name":"do","containerName":"_setup_database","kind":12},{"kind":13,"containerName":"_setup_database","line":157,"name":"$dbh"},{"containerName":"_setup_database","kind":12,"line":157,"name":"commit"},{"containerName":"_setup_database","kind":13,"line":160,"name":"$log"},{"name":"error","line":160,"containerName":"_setup_database","kind":12},{"kind":13,"containerName":"_setup_database","name":"$log","line":164},{"name":"info","line":164,"containerName":"_setup_database","kind":12},{"line":165,"name":"$dbh","containerName":"_setup_database","kind":13},{"containerName":"_setup_database","kind":12,"line":165,"name":"disconnect"}],"containerName":"main::","kind":12,"definition":"sub","name":"_setup_database","range":{"end":{"line":167,"character":9999},"start":{"line":115,"character":0}},"line":115},{"line":117,"name":"db_file","kind":12},{"kind":12,"name":"_get_DBH","line":120},{"range":{"start":{"character":0,"line":170},"end":{"character":9999,"line":197}},"line":170,"name":"_report","definition":"sub","containerName":"main::","children":[{"kind":13,"containerName":"_report","definition":"my","name":"$self","localvar":"my","line":171},{"kind":13,"containerName":"_report","definition":"my","name":"$dbh","localvar":"my","line":172},{"line":172,"name":"$self","containerName":"_report","kind":13},{"line":173,"localvar":"my","name":"$qry","definition":"my","kind":13,"containerName":"_report"},{"definition":"my","containerName":"_report","kind":13,"line":191,"name":"$sth","localvar":"my"},{"name":"$dbh","line":191,"containerName":"_report","kind":13},{"kind":12,"containerName":"_report","line":191,"name":"prepare"},{"containerName":"_report","kind":13,"line":191,"name":"$qry"},{"name":"$sth","line":192,"kind":13,"containerName":"_report"},{"name":"execute","line":192,"kind":12,"containerName":"_report"},{"line":193,"localvar":"my","name":"$row","definition":"my","containerName":"_report","kind":13},{"containerName":"_report","kind":13,"name":"$sth","line":193},{"line":193,"name":"fetchrow_hashref","containerName":"_report","kind":12},{"kind":13,"containerName":"_report","line":194,"name":"$log"},{"kind":12,"containerName":"_report","line":194,"name":"info"},{"containerName":"_report","kind":13,"line":196,"name":"$dbh"},{"line":196,"name":"disconnect","kind":12,"containerName":"_report"}],"kind":12},{"name":"_get_DBH","line":172,"kind":12},{"kind":12,"line":172,"name":"db_file"},{"name":"run","range":{"end":{"character":9999,"line":259},"start":{"line":223,"character":0}},"line":223,"kind":12,"children":[{"localvar":"my","name":"$self","line":224,"containerName":"run","kind":13,"definition":"my"},{"containerName":"run","kind":13,"definition":"my","name":"$sig_handler","localvar":"my","line":227},{"line":228,"name":"$exit_flag","kind":13,"containerName":"run"},{"containerName":"run","kind":13,"name":"$ip_block_queue","line":230},{"containerName":"run","kind":12,"name":"enqueue","line":230},{"name":"$log","line":231,"kind":13,"containerName":"run"},{"kind":12,"containerName":"run","line":231,"name":"info"},{"kind":12,"containerName":"run","line":233,"name":"new"},{"kind":13,"containerName":"run","line":233,"name":"$sig_handler"},{"name":"new","line":234,"kind":12,"containerName":"run"},{"kind":13,"containerName":"run","name":"$sig_handler","line":234},{"name":"$queue","localvar":"my","line":237,"kind":13,"containerName":"run","definition":"my"},{"line":237,"name":"new","kind":12,"containerName":"run"},{"containerName":"run","kind":13,"definition":"my","name":"$sub_block_ip_args","localvar":"my","line":240},{"containerName":"run","kind":13,"name":"$self","line":242},{"name":"$self","line":243,"containerName":"run","kind":13},{"kind":13,"containerName":"run","name":"$self","line":244},{"containerName":"run","kind":13,"name":"$self","line":245},{"kind":13,"containerName":"run","name":"$self","line":246},{"kind":13,"containerName":"run","definition":"my","name":"$ip_block_thread","localvar":"my","line":250},{"line":250,"name":"create","kind":12,"containerName":"run"},{"containerName":"run","kind":13,"name":"$sub_block_ip_args","line":250},{"line":252,"name":"$log","kind":13,"containerName":"run"},{"containerName":"run","kind":12,"line":252,"name":"info"},{"localvar":"my","name":"@threads","line":255,"containerName":"run","kind":13,"definition":"my"},{"kind":13,"containerName":"run","line":257,"name":"$log"},{"containerName":"run","kind":12,"name":"debug","line":257},{"name":"$self","line":257,"containerName":"run","kind":13},{"containerName":"run","kind":13,"definition":"my","localvar":"my","name":"$log_to_review","line":259},{"kind":13,"containerName":"run","name":"$self","line":259}],"containerName":"main::","definition":"sub"},{"line":233,"name":"sigaction","kind":12},{"line":233,"name":"SIGINT","kind":12},{"line":233,"name":"POSIX","containerName":"SigAction","kind":12},{"kind":12,"line":234,"name":"sigaction"},{"kind":12,"line":234,"name":"SIGTERM"},{"name":"POSIX","line":234,"containerName":"SigAction","kind":12},{"line":237,"name":"Thread","containerName":"Queue","kind":12},{"kind":12,"line":242,"name":"chain"},{"kind":12,"name":"chain","line":242},{"line":243,"name":"element","kind":12},{"line":243,"name":"element","kind":12},{"kind":12,"line":244,"name":"table"},{"kind":12,"name":"table","line":244},{"kind":12,"name":"db_file","line":245},{"line":245,"name":"db_file","kind":12},{"name":"timeout","line":246,"kind":12},{"kind":12,"name":"timeout","line":246},{"line":250,"name":"threads","kind":12},{"line":250,"name":"block_ips","kind":12},{"kind":12,"line":257,"name":"Dumper"},{"name":"configs","line":259,"kind":12},{"line":259,"name":"logfile","kind":12},{"definition":"my","kind":13,"containerName":null,"line":260,"name":"$log_config","localvar":"my"},{"kind":13,"containerName":null,"line":260,"name":"%self"},{"kind":12,"name":"configs","line":260},{"kind":12,"line":260,"name":"logfile"},{"name":"$log_to_review","line":260,"kind":13,"containerName":null},{"name":"%log_config","line":261,"containerName":null,"kind":13},{"kind":12,"name":"logfile","line":261},{"kind":13,"containerName":null,"line":261,"name":"$log_to_review"},{"containerName":null,"kind":13,"line":262,"name":"%log_config"},{"kind":12,"line":262,"name":"nftables_setup"},{"containerName":null,"kind":13,"line":262,"name":"$sub_block_ip_args"},{"kind":13,"containerName":null,"name":"$log","line":263},{"containerName":"main::","kind":12,"line":263,"name":"info"},{"name":"@threads","line":264,"kind":13,"containerName":null},{"name":"threads","line":264,"kind":12},{"line":264,"name":"create","containerName":"main::","kind":12},{"name":"process_log_file","line":264,"kind":12},{"line":264,"name":"$log_config","kind":13,"containerName":null},{"definition":"my","kind":13,"containerName":null,"line":267,"localvar":"my","name":"$thr"},{"line":267,"name":"@threads","containerName":null,"kind":13},{"containerName":null,"kind":13,"line":268,"name":"$thr"},{"line":268,"name":"join","containerName":"main::","kind":12},{"kind":13,"containerName":null,"name":"$ip_block_thread","line":272},{"name":"join","line":272,"kind":12,"containerName":"main::"},{"line":275,"range":{"end":{"character":9999,"line":313},"start":{"character":0,"line":275}},"name":"block_ips","definition":"sub","containerName":"main::","children":[{"line":276,"name":"$args","localvar":"my","definition":"my","kind":13,"containerName":"block_ips"},{"containerName":"block_ips","kind":12,"line":277,"name":"put"},{"name":"tid","line":277,"containerName":"block_ips","kind":12},{"kind":13,"containerName":"block_ips","definition":"my","name":"$chain","localvar":"my","line":279},{"containerName":"block_ips","kind":13,"name":"$args","line":279},{"containerName":"block_ips","kind":13,"definition":"my","name":"$table","localvar":"my","line":280},{"name":"$args","line":280,"kind":13,"containerName":"block_ips"},{"name":"$element","localvar":"my","line":281,"containerName":"block_ips","kind":13,"definition":"my"},{"kind":13,"containerName":"block_ips","name":"$args","line":281},{"definition":"my","containerName":"block_ips","kind":13,"line":282,"name":"$db_file","localvar":"my"},{"line":282,"name":"$args","kind":13,"containerName":"block_ips"},{"kind":13,"containerName":"block_ips","line":283,"name":"$log"},{"name":"info","line":283,"kind":12,"containerName":"block_ips"},{"definition":"my","containerName":"block_ips","kind":13,"line":286,"name":"$dsn","localvar":"my"},{"definition":"my","containerName":"block_ips","kind":13,"line":287,"name":"$dbh","localvar":"my"},{"containerName":"block_ips","kind":13,"line":287,"name":"$dsn"},{"containerName":"block_ips","kind":13,"name":"$log","line":287},{"line":287,"name":"error","kind":12,"containerName":"block_ips"},{"line":290,"name":"$q_item","localvar":"my","definition":"my","containerName":"block_ips","kind":13},{"line":290,"name":"$ip_block_queue","kind":13,"containerName":"block_ips"},{"kind":12,"containerName":"block_ips","line":290,"name":"dequeue"},{"line":291,"name":"$q_item","kind":13,"containerName":"block_ips"},{"containerName":"block_ips","kind":13,"definition":"my","name":"$ip","localvar":"my","line":292},{"name":"$q_item","line":292,"containerName":"block_ips","kind":13},{"line":294,"name":"$table","containerName":"block_ips","kind":13},{"name":"$element","line":294,"containerName":"block_ips","kind":13},{"line":294,"name":"$ip","kind":13,"containerName":"block_ips"},{"name":"$log","line":295,"containerName":"block_ips","kind":13},{"line":295,"name":"info","containerName":"block_ips","kind":12},{"definition":"my","containerName":"block_ips","kind":13,"line":299,"localvar":"my","name":"$logfile"},{"line":299,"name":"$q_item","kind":13,"containerName":"block_ips"},{"line":301,"name":"$cmd","localvar":"my","definition":"my","kind":13,"containerName":"block_ips"},{"line":305,"name":"$cmd","kind":13,"containerName":"block_ips"},{"name":"$log","line":306,"kind":13,"containerName":"block_ips"},{"name":"info","line":306,"containerName":"block_ips","kind":12},{"name":"$dbh","line":307,"kind":13,"containerName":"block_ips"},{"containerName":"block_ips","kind":13,"line":307,"name":"$ip"},{"name":"$logfile","line":307,"containerName":"block_ips","kind":13},{"kind":13,"containerName":"block_ips","name":"$log","line":309},{"name":"error","line":309,"containerName":"block_ips","kind":12},{"kind":13,"containerName":"block_ips","line":312,"name":"$dbh"},{"name":"disconnect","line":312,"containerName":"block_ips","kind":12}],"kind":12},{"line":277,"name":"Log","containerName":"Log4perl::MDC","kind":12},{"kind":12,"line":277,"name":"threads"},{"kind":12,"line":279,"name":"chain"},{"kind":12,"name":"table","line":280},{"kind":12,"name":"element","line":281},{"name":"db_file","line":282,"kind":12},{"kind":12,"line":287,"name":"_get_DBH"},{"kind":12,"line":292,"name":"ip"},{"line":294,"name":"_ip_in_nftables","kind":12},{"line":294,"name":"table","kind":12},{"kind":12,"line":294,"name":"element"},{"kind":12,"line":294,"name":"ip"},{"name":"logfile","line":299,"kind":12},{"kind":12,"line":307,"name":"_add_bad_ip_to_db"},{"line":307,"name":"dbh","kind":12},{"line":307,"name":"ip","kind":12},{"kind":12,"line":307,"name":"logfile"},{"definition":"sub","kind":12,"children":[{"localvar":"my","name":"$args","line":324,"containerName":"_ip_in_nftables","kind":13,"definition":"my"},{"containerName":"_ip_in_nftables","kind":13,"definition":"my","localvar":"my","name":"$table","line":325},{"kind":13,"containerName":"_ip_in_nftables","name":"$args","line":325},{"kind":13,"containerName":"_ip_in_nftables","definition":"my","localvar":"my","name":"$element","line":326},{"kind":13,"containerName":"_ip_in_nftables","name":"$args","line":326},{"kind":13,"containerName":"_ip_in_nftables","definition":"my","name":"$ip","localvar":"my","line":327},{"containerName":"_ip_in_nftables","kind":13,"name":"$args","line":327},{"line":329,"localvar":"my","name":"$cmd","definition":"my","containerName":"_ip_in_nftables","kind":13},{"kind":13,"containerName":"_ip_in_nftables","definition":"my","name":"$json_output","localvar":"my","line":330},{"containerName":"_ip_in_nftables","kind":13,"definition":"my","localvar":"my","name":"$nft_data","line":331},{"kind":13,"containerName":"_ip_in_nftables","name":"$json_output","line":331},{"kind":13,"containerName":"_ip_in_nftables","definition":"my","localvar":"my","name":"$nftables","line":332},{"kind":13,"containerName":"_ip_in_nftables","line":332,"name":"$nft_data"},{"line":333,"localvar":"my","name":"$nftable","definition":"my","kind":13,"containerName":"_ip_in_nftables"},{"kind":13,"containerName":"_ip_in_nftables","line":333,"name":"$nftables"},{"name":"$nftable","line":334,"kind":13,"containerName":"_ip_in_nftables"},{"line":335,"name":"$nftable","kind":13,"containerName":"_ip_in_nftables"},{"line":336,"name":"$nftable","kind":13,"containerName":"_ip_in_nftables"},{"line":336,"name":"$element","containerName":"_ip_in_nftables","kind":13},{"name":"$nftable","line":337,"kind":13,"containerName":"_ip_in_nftables"},{"containerName":"_ip_in_nftables","kind":13,"name":"$table","line":337},{"localvar":"my","name":"$elements","line":338,"kind":13,"containerName":"_ip_in_nftables","definition":"my"},{"containerName":"_ip_in_nftables","kind":13,"name":"$nftable","line":338},{"line":339,"localvar":"my","name":"$elem","definition":"my","kind":13,"containerName":"_ip_in_nftables"},{"line":339,"name":"$elements","kind":13,"containerName":"_ip_in_nftables"},{"kind":13,"containerName":"_ip_in_nftables","definition":"my","name":"$actual_elem","localvar":"my","line":340},{"kind":13,"containerName":"_ip_in_nftables","line":340,"name":"$elem"},{"name":"$actual_elem","line":341,"containerName":"_ip_in_nftables","kind":13},{"name":"$ip","line":341,"kind":13,"containerName":"_ip_in_nftables"},{"containerName":"_ip_in_nftables","kind":13,"name":"$log","line":342},{"line":342,"name":"info","containerName":"_ip_in_nftables","kind":12}],"containerName":"main::","line":320,"range":{"start":{"character":0,"line":320},"end":{"character":9999,"line":350}},"name":"_ip_in_nftables"},{"line":325,"name":"table","kind":12},{"line":326,"name":"element","kind":12},{"name":"ip","line":327,"kind":12},{"line":331,"name":"decode_json","kind":12},{"kind":12,"line":332,"name":"nftables"},{"kind":12,"line":334,"name":"set"},{"kind":12,"line":334,"name":"name"},{"line":335,"name":"set","kind":12},{"kind":12,"name":"table","line":335},{"kind":12,"line":336,"name":"set"},{"line":336,"name":"name","kind":12},{"kind":12,"name":"set","line":337},{"line":337,"name":"table","kind":12},{"name":"set","line":338,"kind":12},{"kind":12,"line":338,"name":"elem"},{"kind":12,"line":340,"name":"elem"},{"line":341,"name":"val","kind":12},{"range":{"end":{"character":9999,"line":380},"start":{"line":352,"character":0}},"line":352,"name":"_add_bad_ip_to_db","definition":"sub","containerName":"main::","children":[{"line":353,"localvar":"my","name":"$args","definition":"my","containerName":"_add_bad_ip_to_db","kind":13},{"definition":"my","containerName":"_add_bad_ip_to_db","kind":13,"line":354,"localvar":"my","name":"$dbh"},{"line":354,"name":"$args","kind":13,"containerName":"_add_bad_ip_to_db"},{"definition":"my","kind":13,"containerName":"_add_bad_ip_to_db","line":355,"name":"$ip","localvar":"my"},{"name":"$args","line":355,"kind":13,"containerName":"_add_bad_ip_to_db"},{"kind":13,"containerName":"_add_bad_ip_to_db","definition":"my","localvar":"my","name":"$logfile","line":356},{"kind":13,"containerName":"_add_bad_ip_to_db","name":"$args","line":356},{"definition":"my","containerName":"_add_bad_ip_to_db","kind":13,"line":357,"localvar":"my","name":"$timestamp"},{"kind":13,"containerName":"_add_bad_ip_to_db","name":"$args","line":357},{"containerName":"_add_bad_ip_to_db","kind":13,"definition":"my","name":"$error","localvar":"my","line":358},{"name":"$ip_id","localvar":"my","line":362,"containerName":"_add_bad_ip_to_db","kind":13,"definition":"my"},{"kind":13,"containerName":"_add_bad_ip_to_db","line":362,"name":"$dbh"},{"containerName":"_add_bad_ip_to_db","kind":13,"line":362,"name":"$ip"},{"localvar":"my","name":"$timestamp_id","line":365,"containerName":"_add_bad_ip_to_db","kind":13,"definition":"my"},{"containerName":"_add_bad_ip_to_db","kind":13,"line":365,"name":"$dbh"},{"kind":13,"containerName":"_add_bad_ip_to_db","line":365,"name":"$timestamp"},{"localvar":"my","name":"$log_file_id","line":368,"kind":13,"containerName":"_add_bad_ip_to_db","definition":"my"},{"kind":13,"containerName":"_add_bad_ip_to_db","name":"$dbh","line":368},{"kind":13,"containerName":"_add_bad_ip_to_db","name":"$logfile","line":368},{"localvar":"my","name":"$qry","line":371,"kind":13,"containerName":"_add_bad_ip_to_db","definition":"my"},{"containerName":"_add_bad_ip_to_db","kind":13,"line":372,"name":"$dbh"},{"containerName":"_add_bad_ip_to_db","kind":12,"line":372,"name":"do"},{"line":372,"name":"$qry","kind":13,"containerName":"_add_bad_ip_to_db"},{"kind":13,"containerName":"_add_bad_ip_to_db","line":372,"name":"$ip_id"},{"line":372,"name":"$timestamp_id","containerName":"_add_bad_ip_to_db","kind":13},{"containerName":"_add_bad_ip_to_db","kind":13,"line":372,"name":"$log_file_id"},{"name":"$log","line":375,"kind":13,"containerName":"_add_bad_ip_to_db"},{"kind":12,"containerName":"_add_bad_ip_to_db","name":"error","line":375},{"line":376,"name":"$error","containerName":"_add_bad_ip_to_db","kind":13},{"line":379,"name":"$error","kind":13,"containerName":"_add_bad_ip_to_db"}],"kind":12},{"kind":12,"name":"dbh","line":354},{"line":355,"name":"ip","kind":12},{"line":356,"name":"logfile","kind":12},{"line":357,"name":"timestamp","kind":12},{"name":"_get_or_insert_id","line":362,"kind":12},{"kind":12,"name":"_get_or_insert_id","line":365},{"name":"_get_or_insert_id","line":368,"kind":12},{"signature":{"label":"_get_or_insert_id($dbh,$table,$column,$value)","parameters":[{"label":"$dbh"},{"label":"$table"},{"label":"$column"},{"label":"$value"}],"documentation":""},"line":382,"definition":"sub","detail":"($dbh,$table,$column,$value)","range":{"start":{"line":382,"character":0},"end":{"character":9999,"line":399}},"name":"_get_or_insert_id","containerName":"main::","children":[{"name":"$dbh","localvar":"my","line":383,"kind":13,"containerName":"_get_or_insert_id","definition":"my"},{"kind":13,"containerName":"_get_or_insert_id","line":383,"name":"$table"},{"kind":13,"containerName":"_get_or_insert_id","name":"$column","line":383},{"containerName":"_get_or_insert_id","kind":13,"line":383,"name":"$value"},{"localvar":"my","name":"$id","line":384,"kind":13,"containerName":"_get_or_insert_id","definition":"my"},{"name":"$qry","localvar":"my","line":387,"kind":13,"containerName":"_get_or_insert_id","definition":"my"},{"definition":"my","kind":13,"containerName":"_get_or_insert_id","line":388,"name":"$sth","localvar":"my"},{"name":"$dbh","line":388,"containerName":"_get_or_insert_id","kind":13},{"kind":12,"containerName":"_get_or_insert_id","name":"prepare","line":388},{"containerName":"_get_or_insert_id","kind":13,"line":388,"name":"$qry"},{"containerName":"_get_or_insert_id","kind":13,"name":"$sth","line":389},{"containerName":"_get_or_insert_id","kind":12,"line":389,"name":"execute"},{"kind":13,"containerName":"_get_or_insert_id","name":"$value","line":389},{"containerName":"_get_or_insert_id","kind":13,"name":"$id","line":390},{"containerName":"_get_or_insert_id","kind":13,"name":"$sth","line":390},{"name":"fetchrow_array","line":390,"containerName":"_get_or_insert_id","kind":12},{"containerName":"_get_or_insert_id","kind":13,"line":393,"name":"$id"},{"name":"$dbh","line":394,"kind":13,"containerName":"_get_or_insert_id"},{"line":394,"name":"do","kind":12,"containerName":"_get_or_insert_id"},{"kind":13,"containerName":"_get_or_insert_id","line":394,"name":"$value"},{"kind":13,"containerName":"_get_or_insert_id","name":"$id","line":395},{"name":"$dbh","line":395,"kind":13,"containerName":"_get_or_insert_id"},{"name":"last_insert_id","line":395,"containerName":"_get_or_insert_id","kind":12},{"kind":13,"containerName":"_get_or_insert_id","line":395,"name":"$table"},{"line":398,"name":"$id","containerName":"_get_or_insert_id","kind":13}],"kind":12},{"name":"_check_nftables_setup","line":423,"range":{"end":{"line":464,"character":9999},"start":{"line":423,"character":0}},"containerName":"main::","children":[{"line":424,"localvar":"my","name":"$self","definition":"my","kind":13,"containerName":"_check_nftables_setup"},{"containerName":"_check_nftables_setup","kind":13,"definition":"my","name":"$chain","localvar":"my","line":425},{"kind":13,"containerName":"_check_nftables_setup","name":"$self","line":425},{"kind":13,"containerName":"_check_nftables_setup","definition":"my","localvar":"my","name":"$element","line":426},{"containerName":"_check_nftables_setup","kind":13,"name":"$self","line":426},{"line":427,"localvar":"my","name":"$table","definition":"my","kind":13,"containerName":"_check_nftables_setup"},{"line":427,"name":"$self","containerName":"_check_nftables_setup","kind":13},{"kind":13,"containerName":"_check_nftables_setup","definition":"my","localvar":"my","name":"$family","line":428},{"containerName":"_check_nftables_setup","kind":13,"name":"$self","line":428},{"definition":"my","containerName":"_check_nftables_setup","kind":13,"line":431,"name":"$cmd","localvar":"my"},{"line":432,"name":"$log","containerName":"_check_nftables_setup","kind":13},{"containerName":"_check_nftables_setup","kind":12,"name":"info","line":432},{"kind":13,"containerName":"_check_nftables_setup","definition":"my","localvar":"my","name":"$output","line":433},{"kind":13,"containerName":"_check_nftables_setup","definition":"my","localvar":"my","name":"$nftables_data","line":436},{"name":"$output","line":436,"kind":13,"containerName":"_check_nftables_setup"},{"localvar":"my","name":"$tables","line":439,"containerName":"_check_nftables_setup","kind":13,"definition":"my"},{"line":439,"name":"$nftables_data","containerName":"_check_nftables_setup","kind":13},{"line":440,"localvar":"my","name":"$table_exists","definition":"my","kind":13,"containerName":"_check_nftables_setup"},{"name":"$table","line":440,"containerName":"_check_nftables_setup","kind":13},{"line":440,"name":"$family","containerName":"_check_nftables_setup","kind":13},{"line":440,"name":"$tables","kind":13,"containerName":"_check_nftables_setup"},{"line":441,"name":"$table_exists","kind":13,"containerName":"_check_nftables_setup"},{"containerName":"_check_nftables_setup","kind":13,"name":"$log","line":442},{"kind":12,"containerName":"_check_nftables_setup","line":442,"name":"debug"},{"kind":13,"containerName":"_check_nftables_setup","definition":"my","localvar":"my","name":"$chains","line":447},{"containerName":"_check_nftables_setup","kind":13,"line":447,"name":"$tables"},{"name":"$chain_exists","localvar":"my","line":448,"containerName":"_check_nftables_setup","kind":13,"definition":"my"},{"name":"$chain","line":448,"containerName":"_check_nftables_setup","kind":13},{"kind":13,"containerName":"_check_nftables_setup","name":"$table","line":448},{"kind":13,"containerName":"_check_nftables_setup","name":"$chains","line":448},{"kind":13,"containerName":"_check_nftables_setup","line":449,"name":"$chain_exists"},{"name":"$log","line":450,"kind":13,"containerName":"_check_nftables_setup"},{"name":"debug","line":450,"containerName":"_check_nftables_setup","kind":12},{"definition":"my","kind":13,"containerName":"_check_nftables_setup","line":455,"localvar":"my","name":"$sets"},{"name":"$tables","line":455,"containerName":"_check_nftables_setup","kind":13},{"line":456,"name":"$set_exists","localvar":"my","definition":"my","containerName":"_check_nftables_setup","kind":13},{"name":"$element","line":456,"containerName":"_check_nftables_setup","kind":13},{"name":"$table","line":456,"containerName":"_check_nftables_setup","kind":13},{"name":"$sets","line":456,"containerName":"_check_nftables_setup","kind":13},{"containerName":"_check_nftables_setup","kind":13,"name":"$set_exists","line":457},{"name":"$log","line":458,"kind":13,"containerName":"_check_nftables_setup"},{"line":458,"name":"debug","kind":12,"containerName":"_check_nftables_setup"},{"name":"$log","line":462,"kind":13,"containerName":"_check_nftables_setup"},{"kind":12,"containerName":"_check_nftables_setup","line":462,"name":"debug"}],"kind":12,"definition":"sub"},{"name":"chain","line":425,"kind":12},{"kind":12,"line":426,"name":"element"},{"kind":12,"name":"table","line":427},{"kind":12,"name":"family","line":428},{"kind":12,"name":"decode_json","line":436},{"kind":12,"line":439,"name":"nftables"},{"name":"table","line":440,"kind":12},{"line":440,"name":"name","kind":12},{"kind":12,"name":"table","line":440},{"kind":12,"name":"family","line":440},{"line":447,"name":"chain","kind":12},{"line":448,"name":"chain","kind":12},{"kind":12,"line":448,"name":"name"},{"kind":12,"name":"chain","line":448},{"name":"table","line":448,"kind":12},{"kind":12,"name":"set","line":455},{"kind":12,"line":456,"name":"set"},{"name":"name","line":456,"kind":12},{"kind":12,"name":"set","line":456},{"name":"table","line":456,"kind":12},{"name":"_delete_nftables_chain","range":{"start":{"character":0,"line":531},"end":{"character":9999,"line":550}},"line":531,"children":[{"line":532,"localvar":"my","name":"$self","definition":"my","kind":13,"containerName":"_delete_nftables_chain"},{"line":533,"name":"$chain","localvar":"my","definition":"my","containerName":"_delete_nftables_chain","kind":13},{"name":"$self","line":533,"kind":13,"containerName":"_delete_nftables_chain"},{"definition":"my","containerName":"_delete_nftables_chain","kind":13,"line":534,"localvar":"my","name":"$table"},{"name":"$self","line":534,"kind":13,"containerName":"_delete_nftables_chain"},{"kind":13,"containerName":"_delete_nftables_chain","definition":"my","name":"$family","localvar":"my","line":535},{"containerName":"_delete_nftables_chain","kind":13,"line":535,"name":"$self"},{"containerName":"_delete_nftables_chain","kind":13,"definition":"my","name":"$cmd","localvar":"my","line":539},{"name":"$log","line":540,"containerName":"_delete_nftables_chain","kind":13},{"line":540,"name":"info","containerName":"_delete_nftables_chain","kind":12},{"kind":13,"containerName":"_delete_nftables_chain","name":"$cmd","line":541},{"line":541,"name":"$log","containerName":"_delete_nftables_chain","kind":13},{"line":541,"name":"info","containerName":"_delete_nftables_chain","kind":12},{"containerName":"_delete_nftables_chain","kind":13,"line":542,"name":"$log"},{"kind":12,"containerName":"_delete_nftables_chain","line":542,"name":"error"},{"line":544,"name":"$cmd","containerName":"_delete_nftables_chain","kind":13},{"name":"$log","line":545,"containerName":"_delete_nftables_chain","kind":13},{"name":"info","line":545,"kind":12,"containerName":"_delete_nftables_chain"},{"containerName":"_delete_nftables_chain","kind":13,"name":"$cmd","line":546},{"kind":13,"containerName":"_delete_nftables_chain","name":"$log","line":546},{"containerName":"_delete_nftables_chain","kind":12,"name":"info","line":546},{"kind":13,"containerName":"_delete_nftables_chain","line":547,"name":"$log"},{"name":"error","line":547,"containerName":"_delete_nftables_chain","kind":12}],"kind":12,"containerName":"main::","definition":"sub"},{"kind":12,"name":"chain","line":533},{"line":534,"name":"table","kind":12},{"line":535,"name":"family","kind":12},{"name":"_create_nftables_chain","range":{"end":{"line":588,"character":9999},"start":{"line":552,"character":0}},"line":552,"children":[{"kind":13,"containerName":"_create_nftables_chain","definition":"my","localvar":"my","name":"$self","line":553},{"localvar":"my","name":"$chain","line":554,"containerName":"_create_nftables_chain","kind":13,"definition":"my"},{"name":"$self","line":554,"kind":13,"containerName":"_create_nftables_chain"},{"kind":13,"containerName":"_create_nftables_chain","definition":"my","localvar":"my","name":"$element","line":555},{"name":"$self","line":555,"kind":13,"containerName":"_create_nftables_chain"},{"localvar":"my","name":"$table","line":556,"kind":13,"containerName":"_create_nftables_chain","definition":"my"},{"name":"$self","line":556,"containerName":"_create_nftables_chain","kind":13},{"line":557,"name":"$timeout","localvar":"my","definition":"my","containerName":"_create_nftables_chain","kind":13},{"containerName":"_create_nftables_chain","kind":13,"name":"$self","line":557},{"line":558,"name":"$family","localvar":"my","definition":"my","kind":13,"containerName":"_create_nftables_chain"},{"kind":13,"containerName":"_create_nftables_chain","line":558,"name":"$self"},{"line":560,"localvar":"my","name":"$cmd","definition":"my","kind":13,"containerName":"_create_nftables_chain"},{"kind":13,"containerName":"_create_nftables_chain","line":561,"name":"$log"},{"containerName":"_create_nftables_chain","kind":12,"line":561,"name":"info"},{"name":"$cmd","line":562,"containerName":"_create_nftables_chain","kind":13},{"containerName":"_create_nftables_chain","kind":13,"name":"$log","line":562},{"line":562,"name":"info","kind":12,"containerName":"_create_nftables_chain"},{"containerName":"_create_nftables_chain","kind":13,"name":"$log","line":563},{"name":"error","line":563,"containerName":"_create_nftables_chain","kind":12},{"name":"$cmd","line":565,"containerName":"_create_nftables_chain","kind":13},{"containerName":"_create_nftables_chain","kind":13,"line":566,"name":"$log"},{"kind":12,"containerName":"_create_nftables_chain","line":566,"name":"info"},{"kind":13,"containerName":"_create_nftables_chain","line":567,"name":"$cmd"},{"kind":13,"containerName":"_create_nftables_chain","line":567,"name":"$log"},{"name":"info","line":567,"kind":12,"containerName":"_create_nftables_chain"},{"kind":13,"containerName":"_create_nftables_chain","line":568,"name":"$log"},{"line":568,"name":"error","containerName":"_create_nftables_chain","kind":12},{"kind":13,"containerName":"_create_nftables_chain","line":571,"name":"$cmd"},{"line":572,"name":"$log","containerName":"_create_nftables_chain","kind":13},{"line":572,"name":"info","containerName":"_create_nftables_chain","kind":12},{"kind":13,"containerName":"_create_nftables_chain","line":573,"name":"$cmd"},{"name":"$log","line":573,"kind":13,"containerName":"_create_nftables_chain"},{"containerName":"_create_nftables_chain","kind":12,"name":"info","line":573},{"name":"$log","line":574,"containerName":"_create_nftables_chain","kind":13},{"name":"error","line":574,"kind":12,"containerName":"_create_nftables_chain"},{"line":576,"name":"$cmd","kind":13,"containerName":"_create_nftables_chain"},{"kind":13,"containerName":"_create_nftables_chain","line":577,"name":"$log"},{"name":"info","line":577,"containerName":"_create_nftables_chain","kind":12},{"name":"$cmd","line":578,"containerName":"_create_nftables_chain","kind":13},{"name":"$log","line":578,"kind":13,"containerName":"_create_nftables_chain"},{"name":"info","line":578,"containerName":"_create_nftables_chain","kind":12},{"line":579,"name":"$log","containerName":"_create_nftables_chain","kind":13},{"kind":12,"containerName":"_create_nftables_chain","line":579,"name":"error"},{"containerName":"_create_nftables_chain","kind":13,"line":582,"name":"$cmd"},{"line":583,"name":"$log","containerName":"_create_nftables_chain","kind":13},{"containerName":"_create_nftables_chain","kind":12,"line":583,"name":"info"},{"kind":13,"containerName":"_create_nftables_chain","line":584,"name":"$cmd"},{"line":584,"name":"$log","containerName":"_create_nftables_chain","kind":13},{"name":"info","line":584,"containerName":"_create_nftables_chain","kind":12},{"line":585,"name":"$log","kind":13,"containerName":"_create_nftables_chain"},{"name":"error","line":585,"containerName":"_create_nftables_chain","kind":12}],"containerName":"main::","kind":12,"definition":"sub"},{"name":"chain","line":554,"kind":12},{"kind":12,"name":"element","line":555},{"kind":12,"line":556,"name":"table"},{"kind":12,"name":"timeout","line":557},{"kind":12,"name":"family","line":558},{"children":[{"localvar":"my","name":"$dsn","line":591,"kind":13,"containerName":"_get_DBH","definition":"my"},{"line":592,"localvar":"my","name":"$dbh","definition":"my","containerName":"_get_DBH","kind":13},{"kind":12,"containerName":"_get_DBH","name":"connect","line":592},{"name":"$dsn","line":592,"containerName":"_get_DBH","kind":13},{"name":"$dbh","line":598,"containerName":"_get_DBH","kind":13}],"kind":12,"containerName":"main::","definition":"sub","name":"_get_DBH","line":590,"range":{"end":{"character":9999,"line":599},"start":{"line":590,"character":0}}},{"line":591,"name":"croak","kind":12},{"line":592,"name":"DBI","kind":12},{"line":593,"name":"PrintError","kind":12},{"line":594,"name":"RaiseError","kind":12},{"name":"AutoCommit","line":595,"kind":12},{"kind":12,"line":597,"name":"croak"},{"containerName":"main::","children":[{"kind":13,"containerName":"process_log_file","definition":"my","localvar":"my","name":"$args","line":602},{"name":"put","line":603,"kind":12,"containerName":"process_log_file"},{"containerName":"process_log_file","kind":12,"line":603,"name":"tid"},{"containerName":"process_log_file","kind":13,"name":"$log","line":604},{"line":604,"name":"debug","containerName":"process_log_file","kind":12},{"kind":13,"containerName":"process_log_file","name":"$args","line":604},{"containerName":"process_log_file","kind":13,"definition":"my","name":"$module","localvar":"my","line":606},{"line":606,"name":"$args","kind":13,"containerName":"process_log_file"},{"kind":13,"containerName":"process_log_file","name":"$module","line":607},{"name":"$module","line":607,"kind":13,"containerName":"process_log_file"},{"containerName":"process_log_file","kind":13,"line":608,"name":"$log"},{"kind":12,"containerName":"process_log_file","name":"info","line":608},{"line":609,"name":"$module","containerName":"process_log_file","kind":13},{"name":"$log","line":609,"containerName":"process_log_file","kind":13},{"line":609,"name":"error","containerName":"process_log_file","kind":12},{"localvar":"my","name":"$scan_interval","line":611,"kind":13,"containerName":"process_log_file","definition":"my"},{"containerName":"process_log_file","kind":13,"name":"$args","line":611},{"definition":"my","containerName":"process_log_file","kind":13,"line":613,"localvar":"my","name":"$review_log_module"},{"name":"$module","line":613,"kind":13,"containerName":"process_log_file"},{"line":613,"name":"new","kind":12,"containerName":"process_log_file"},{"name":"$args","line":613,"kind":13,"containerName":"process_log_file"},{"definition":"my","kind":13,"containerName":"process_log_file","line":616,"name":"$bad_ips","localvar":"my"},{"line":616,"name":"$review_log_module","containerName":"process_log_file","kind":13},{"line":616,"name":"run","kind":12,"containerName":"process_log_file"},{"name":"$exit_flag","line":618,"containerName":"process_log_file","kind":13},{"line":620,"name":"$logmsg","localvar":"my","definition":"my","containerName":"process_log_file","kind":13},{"name":"$bad_ips","line":620,"kind":13,"containerName":"process_log_file"},{"line":620,"name":"$bad_ips","containerName":"process_log_file","kind":13},{"containerName":"process_log_file","kind":13,"name":"$log","line":621},{"name":"debug","line":621,"kind":12,"containerName":"process_log_file"},{"name":"$logmsg","line":621,"kind":13,"containerName":"process_log_file"},{"line":622,"name":"$args","kind":13,"containerName":"process_log_file"},{"containerName":"process_log_file","kind":13,"name":"$bad_ips","line":622},{"containerName":"process_log_file","kind":13,"name":"$args","line":624},{"kind":13,"containerName":"process_log_file","name":"$log","line":624},{"name":"error","line":624,"containerName":"process_log_file","kind":12},{"containerName":"process_log_file","kind":13,"definition":"my","name":"$i","localvar":"my","line":626},{"name":"$i","line":626,"containerName":"process_log_file","kind":13},{"name":"$scan_interval","line":626,"containerName":"process_log_file","kind":13},{"line":626,"name":"$i","containerName":"process_log_file","kind":13},{"kind":13,"containerName":"process_log_file","name":"$log","line":627},{"name":"info","line":627,"containerName":"process_log_file","kind":12},{"line":627,"name":"$exit_flag","containerName":"process_log_file","kind":13},{"name":"$exit_flag","line":631,"kind":13,"containerName":"process_log_file"},{"name":"$log","line":634,"containerName":"process_log_file","kind":13},{"kind":12,"containerName":"process_log_file","name":"info","line":634}],"kind":12,"definition":"sub","name":"process_log_file","line":601,"range":{"end":{"character":9999,"line":637},"start":{"character":0,"line":601}}},{"kind":12,"containerName":"Log4perl::MDC","name":"Log","line":603},{"kind":12,"line":603,"name":"threads"},{"kind":12,"name":"Dumper","line":604},{"kind":12,"name":"module","line":606},{"name":"load","line":609,"kind":12},{"kind":12,"line":611,"name":"scan_interval"},{"name":"bad_ips","line":622,"kind":12},{"kind":12,"name":"_add_bad_ips_to_queue","line":624},{"definition":"sub","containerName":"main::","children":[{"localvar":"my","name":"$scan_interval","line":640,"containerName":"_scan_interval_sleeper","kind":13,"definition":"my"},{"containerName":"_scan_interval_sleeper","kind":13,"definition":"my","name":"$i","localvar":"my","line":641},{"containerName":"_scan_interval_sleeper","kind":13,"line":641,"name":"$i"},{"containerName":"_scan_interval_sleeper","kind":13,"line":641,"name":"$scan_interval"},{"line":641,"name":"$i","containerName":"_scan_interval_sleeper","kind":13},{"kind":13,"containerName":"_scan_interval_sleeper","line":642,"name":"$log"},{"kind":12,"containerName":"_scan_interval_sleeper","line":642,"name":"info"},{"line":642,"name":"$exit_flag","containerName":"_scan_interval_sleeper","kind":13}],"kind":12,"line":639,"range":{"start":{"line":639,"character":0},"end":{"line":645,"character":9999}},"name":"_scan_interval_sleeper"},{"line":647,"signature":{"documentation":"","parameters":[{"label":"$args"}],"label":"_add_bad_ips_to_queue($args)"},"detail":"($args)","definition":"sub","range":{"start":{"character":0,"line":647},"end":{"character":9999,"line":681}},"name":"_add_bad_ips_to_queue","children":[{"definition":"my","containerName":"_add_bad_ips_to_queue","kind":13,"line":648,"localvar":"my","name":"$args"},{"definition":"my","kind":13,"containerName":"_add_bad_ips_to_queue","line":649,"name":"$bad_ips","localvar":"my"},{"line":649,"name":"$args","containerName":"_add_bad_ips_to_queue","kind":13},{"kind":13,"containerName":"_add_bad_ips_to_queue","definition":"my","localvar":"my","name":"$logfile","line":650},{"name":"$args","line":650,"containerName":"_add_bad_ips_to_queue","kind":13},{"line":652,"name":"@q_args","localvar":"my","definition":"my","containerName":"_add_bad_ips_to_queue","kind":13},{"name":"@q_args","line":656,"containerName":"_add_bad_ips_to_queue","kind":13},{"containerName":"_add_bad_ips_to_queue","kind":13,"name":"$logfile","line":656},{"name":"$bad_ips","line":656,"containerName":"_add_bad_ips_to_queue","kind":13},{"name":"$log","line":662,"containerName":"_add_bad_ips_to_queue","kind":13},{"kind":12,"containerName":"_add_bad_ips_to_queue","name":"debug","line":662},{"name":"@q_args","line":662,"kind":13,"containerName":"_add_bad_ips_to_queue"},{"kind":13,"containerName":"_add_bad_ips_to_queue","name":"$log","line":664},{"kind":12,"containerName":"_add_bad_ips_to_queue","name":"debug","line":664},{"line":664,"name":"@q_args","kind":13,"containerName":"_add_bad_ips_to_queue"},{"line":666,"name":"$error","localvar":"my","definition":"my","containerName":"_add_bad_ips_to_queue","kind":13},{"localvar":"my","name":"$ip_log","line":668,"containerName":"_add_bad_ips_to_queue","kind":13,"definition":"my"},{"name":"@q_args","line":668,"kind":13,"containerName":"_add_bad_ips_to_queue"},{"line":669,"name":"$ip_block_queue","kind":13,"containerName":"_add_bad_ips_to_queue"},{"line":669,"name":"enqueue","containerName":"_add_bad_ips_to_queue","kind":12},{"name":"$ip_log","line":669,"kind":13,"containerName":"_add_bad_ips_to_queue"},{"line":671,"name":"$error","containerName":"_add_bad_ips_to_queue","kind":13},{"containerName":"_add_bad_ips_to_queue","kind":13,"line":672,"name":"$log"},{"line":672,"name":"error","containerName":"_add_bad_ips_to_queue","kind":12},{"name":"$ip_log","line":672,"containerName":"_add_bad_ips_to_queue","kind":13},{"kind":13,"containerName":"_add_bad_ips_to_queue","name":"$error","line":675},{"line":676,"name":"$log","kind":13,"containerName":"_add_bad_ips_to_queue"},{"line":676,"name":"error","kind":12,"containerName":"_add_bad_ips_to_queue"}],"containerName":"main::","kind":12},{"kind":12,"name":"bad_ips","line":649},{"line":650,"name":"logfile","kind":12},{"name":"logfile","line":656,"kind":12},{"line":656,"name":"ip","kind":12},{"kind":12,"name":"Dumper","line":664},{"line":672,"name":"Dumper","kind":12},{"children":[{"kind":13,"containerName":"DESTROY","definition":"my","localvar":"my","name":"$self","line":684},{"containerName":"DESTROY","kind":13,"name":"$log","line":685},{"kind":12,"containerName":"DESTROY","name":"info","line":685}],"kind":12,"containerName":"main::","definition":"sub","name":"DESTROY","line":683,"range":{"end":{"character":9999,"line":686},"start":{"character":0,"line":683}}}]}