{"version":5,"vars":[{"definition":1,"kind":2,"line":0,"name":"NftablesBlocker::DefaultExtractor"},{"name":"strict","line":2,"containerName":"","kind":2},{"containerName":"","kind":2,"name":"warnings","line":3},{"containerName":"","kind":2,"name":"Fcntl","line":4},{"name":"Any","line":5,"containerName":"Log","kind":2},{"containerName":"Data","kind":2,"line":6,"name":"Dumper"},{"kind":2,"containerName":"","line":7,"name":"JSON"},{"kind":13,"containerName":null,"name":"$Data","line":9},{"kind":12,"containerName":"Indent","line":9,"name":"Dumper"},{"kind":13,"containerName":null,"line":10,"name":"$Data"},{"kind":12,"containerName":"Sort","name":"Dumper","line":10},{"definition":"my","kind":13,"containerName":null,"line":12,"localvar":"my","name":"$REGEX_IPV4"},{"definition":"sub","detail":"($class,$args)","line":32,"signature":{"label":"new($class,$args)","parameters":[{"label":"$class"},{"label":"$args"}],"documentation":" REGEX_IPV6 is not used and untested.  Provided here for future modules, add-ons, bolt-ons or for whomever to try.\n my $REGEX_IPV6 = qr/(\n     (?:[A-Fa-f0-9]{1,4}:){7}[A-Fa-f0-9]{1,4}|\n     (?:[A-Fa-f0-9]{1,4}:){1,7}:|\n     (?:[A-Fa-f0-9]{1,4}:){1,6}:[A-Fa-f0-9]{1,4}|\n     (?:[A-Fa-f0-9]{1,4}:){1,5}(?::[A-Fa-f0-9]{1,4}){1,2}|\n     (?:[A-Fa-f0-9]{1,4}:){1,4}(?::[A-Fa-f0-9]{1,4}){1,3}|\n     (?:[A-Fa-f0-9]{1,4}:){1,3}(?::[A-Fa-f0-9]{1,4}){1,4}|\n     (?:[A-Fa-f0-9]{1,4}:){1,2}(?::[A-Fa-f0-9]{1,4}){1,5}|\n     [A-Fa-f0-9]{1,4}(?::[A-Fa-f0-9]{1,4}){1,6}|\n     :(?::[A-Fa-f0-9]{1,4}){1,7}|:\n     fe80:(?::[A-Fa-f0-9]{0,4}){0,4}%[0-9a-zA-Z]{1,}|\n     ::(ffff(?::0{1,4}){0,1}:){0,1}\n     (?:[0-9]{1,3}\\.){3}[0-9]{1,3}|\n     (?:[A-Fa-f0-9]{1,4}:){1,4}:\n     (?:[0-9]{1,3}\\.){3}[0-9]{1,3}\n )/x;"},"children":[{"kind":13,"containerName":"new","definition":"my","name":"$class","localvar":"my","line":33},{"kind":13,"containerName":"new","name":"$args","line":33},{"kind":13,"containerName":"new","line":34,"name":"$log"},{"containerName":"new","kind":12,"name":"info","line":34},{"line":35,"name":"$self","localvar":"my","definition":"my","kind":13,"containerName":"new"},{"containerName":"new","kind":13,"name":"$args","line":36},{"name":"$self","line":38,"containerName":"new","kind":13},{"kind":13,"containerName":"new","name":"$class","line":38},{"containerName":"new","kind":13,"name":"$self","line":39}],"kind":12,"containerName":"NftablesBlocker::DefaultExtractor","range":{"start":{"line":32,"character":0},"end":{"line":40,"character":9999}},"name":"new"},{"kind":12,"line":36,"name":"args"},{"name":"run","range":{"start":{"character":0,"line":42},"end":{"character":9999,"line":63}},"line":42,"containerName":"NftablesBlocker::DefaultExtractor","children":[{"definition":"my","kind":13,"containerName":"run","line":43,"name":"$self","localvar":"my"},{"containerName":"run","kind":13,"line":44,"name":"$log"},{"name":"info","line":44,"containerName":"run","kind":12},{"kind":13,"containerName":"run","definition":"my","localvar":"my","name":"$bad_ips","line":46},{"containerName":"run","kind":13,"name":"$self","line":46},{"line":46,"name":"extract_bad_ips","kind":12,"containerName":"run"},{"containerName":"run","kind":13,"name":"$self","line":46},{"definition":"my","containerName":"run","kind":13,"line":49,"name":"$cleaned_bad_ips","localvar":"my"},{"kind":13,"containerName":"run","definition":"my","localvar":"my","name":"$table","line":50},{"containerName":"run","kind":13,"line":50,"name":"$self"},{"kind":13,"containerName":"run","definition":"my","name":"$element","localvar":"my","line":51},{"line":51,"name":"$self","containerName":"run","kind":13},{"definition":"my","kind":13,"containerName":"run","line":52,"localvar":"my","name":"$nftables_element_set"},{"containerName":"run","kind":13,"name":"$table","line":52},{"name":"$element","line":52,"kind":13,"containerName":"run"},{"name":"$bad_ip","localvar":"my","line":53,"containerName":"run","kind":13,"definition":"my"},{"kind":13,"containerName":"run","name":"$bad_ips","line":53},{"containerName":"run","kind":13,"name":"$table","line":54},{"name":"$element","line":54,"containerName":"run","kind":13},{"line":54,"name":"$bad_ip","containerName":"run","kind":13},{"line":54,"name":"$nftables_element_set","kind":13,"containerName":"run"},{"name":"$log","line":58,"kind":13,"containerName":"run"},{"containerName":"run","kind":12,"name":"info","line":58},{"containerName":"run","kind":13,"name":"$cleaned_bad_ips","line":59},{"name":"$bad_ip","line":59,"containerName":"run","kind":13},{"containerName":"run","kind":13,"name":"$cleaned_bad_ips","line":62}],"kind":12,"definition":"sub"},{"kind":12,"name":"args","line":46},{"line":50,"name":"args","kind":12},{"line":50,"name":"nftables_setup","kind":12},{"line":50,"name":"table","kind":12},{"kind":12,"name":"args","line":51},{"line":51,"name":"nftables_setup","kind":12},{"kind":12,"line":51,"name":"element"},{"name":"_get_nftables_to_json","line":52,"kind":12},{"kind":12,"line":52,"name":"table"},{"kind":12,"name":"element","line":52},{"kind":12,"name":"_ip_in_nftables","line":54},{"line":54,"name":"table","kind":12},{"name":"element","line":54,"kind":12},{"kind":12,"line":54,"name":"ip"},{"kind":12,"name":"nftables_set","line":54},{"definition":"sub","detail":"($self,$args)","signature":{"documentation":"","parameters":[{"label":"$self"},{"label":"$args"}],"label":"_read_files($self,$args)"},"line":66,"kind":12,"containerName":"NftablesBlocker::DefaultExtractor","children":[{"kind":13,"containerName":"_read_files","definition":"my","localvar":"my","name":"$self","line":67},{"kind":13,"containerName":"_read_files","name":"$args","line":67},{"definition":"my","kind":13,"containerName":"_read_files","line":68,"localvar":"my","name":"$files"},{"line":68,"name":"$args","kind":13,"containerName":"_read_files"},{"name":"$logfile","localvar":"my","line":69,"containerName":"_read_files","kind":13,"definition":"my"},{"name":"$args","line":69,"containerName":"_read_files","kind":13},{"definition":"my","kind":13,"containerName":"_read_files","line":70,"localvar":"my","name":"@file_contents"},{"line":72,"name":"$files","kind":13,"containerName":"_read_files"},{"name":"$files","line":72,"kind":13,"containerName":"_read_files"},{"kind":13,"containerName":"_read_files","line":73,"name":"$log"},{"kind":12,"containerName":"_read_files","name":"info","line":73},{"containerName":"_read_files","kind":13,"name":"$logfile","line":77},{"line":78,"name":"$log","kind":13,"containerName":"_read_files"},{"kind":12,"containerName":"_read_files","line":78,"name":"info"},{"definition":"my","containerName":"_read_files","kind":13,"line":82,"localvar":"my","name":"$file"},{"kind":13,"containerName":"_read_files","name":"$files","line":82},{"definition":"my","containerName":"_read_files","kind":13,"line":83,"localvar":"my","name":"$seek_pos"},{"kind":13,"containerName":"_read_files","name":"$self","line":83},{"name":"$logfile","line":83,"kind":13,"containerName":"_read_files"},{"name":"$file","line":83,"kind":13,"containerName":"_read_files"},{"line":84,"localvar":"my","name":"$filename","definition":"my","containerName":"_read_files","kind":13},{"kind":13,"containerName":"_read_files","line":84,"name":"$files"},{"name":"$file","line":84,"containerName":"_read_files","kind":13},{"line":86,"name":"$fh","localvar":"my","definition":"my","kind":13,"containerName":"_read_files"},{"name":"$fh","line":87,"kind":13,"containerName":"_read_files"},{"line":87,"name":"$filename","kind":13,"containerName":"_read_files"},{"containerName":"_read_files","kind":13,"line":88,"name":"$log"},{"kind":12,"containerName":"_read_files","name":"info","line":88},{"line":92,"name":"$fh","containerName":"_read_files","kind":13},{"containerName":"_read_files","kind":13,"line":92,"name":"$seek_pos"},{"definition":"my","containerName":"_read_files","kind":13,"line":94,"name":"%seen","localvar":"my"},{"name":"$line","localvar":"my","line":95,"kind":13,"containerName":"_read_files","definition":"my"},{"name":"$fh","line":95,"kind":13,"containerName":"_read_files"},{"containerName":"_read_files","kind":13,"line":96,"name":"$line"},{"line":97,"name":"$line","containerName":"_read_files","kind":13},{"name":"$seen","line":98,"kind":13,"containerName":"_read_files"},{"line":98,"name":"$line","containerName":"_read_files","kind":13},{"line":99,"name":"@file_contents","kind":13,"containerName":"_read_files"},{"kind":13,"containerName":"_read_files","name":"$line","line":99},{"name":"$self","line":102,"kind":13,"containerName":"_read_files"},{"line":102,"name":"$logfile","kind":13,"containerName":"_read_files"},{"kind":13,"containerName":"_read_files","line":102,"name":"$file"},{"kind":13,"containerName":"_read_files","line":102,"name":"$args"},{"line":102,"name":"$fh","kind":13,"containerName":"_read_files"},{"line":103,"name":"$fh","kind":13,"containerName":"_read_files"},{"name":"@file_contents","line":106,"containerName":"_read_files","kind":13}],"range":{"end":{"character":9999,"line":107},"start":{"line":66,"character":0}},"name":"_read_files"},{"name":"files","line":68,"kind":12},{"line":69,"name":"logfile","kind":12},{"kind":12,"name":"seek_pos","line":83},{"kind":12,"name":"seek_pos","line":102},{"kind":12,"line":102,"name":"read_all"},{"definition":"sub","detail":"($self,$args)","signature":{"label":"extract_bad_ips($self,$args)","parameters":[{"label":"$self"},{"label":"$args"}],"documentation":""},"line":110,"kind":12,"children":[{"localvar":"my","name":"$self","line":111,"kind":13,"containerName":"extract_bad_ips","definition":"my"},{"line":111,"name":"$args","kind":13,"containerName":"extract_bad_ips"},{"containerName":"extract_bad_ips","kind":13,"name":"$log","line":112},{"name":"info","line":112,"kind":12,"containerName":"extract_bad_ips"},{"definition":"my","containerName":"extract_bad_ips","kind":13,"line":114,"name":"$files","localvar":"my"},{"name":"$args","line":114,"containerName":"extract_bad_ips","kind":13},{"line":115,"localvar":"my","name":"$regexes","definition":"my","kind":13,"containerName":"extract_bad_ips"},{"line":115,"name":"$args","kind":13,"containerName":"extract_bad_ips"},{"containerName":"extract_bad_ips","kind":13,"name":"$files","line":117},{"line":118,"name":"$log","kind":13,"containerName":"extract_bad_ips"},{"line":118,"name":"info","kind":12,"containerName":"extract_bad_ips"},{"kind":13,"containerName":"extract_bad_ips","name":"$regexes","line":122},{"kind":13,"containerName":"extract_bad_ips","name":"$log","line":123},{"name":"info","line":123,"containerName":"extract_bad_ips","kind":12},{"kind":13,"containerName":"extract_bad_ips","definition":"my","name":"$file_contents_ref","localvar":"my","line":127},{"name":"$self","line":127,"containerName":"extract_bad_ips","kind":13},{"name":"_read_files","line":127,"containerName":"extract_bad_ips","kind":12},{"name":"$args","line":127,"kind":13,"containerName":"extract_bad_ips"},{"definition":"my","containerName":"extract_bad_ips","kind":13,"line":128,"localvar":"my","name":"@file_contents"},{"kind":13,"containerName":"extract_bad_ips","line":128,"name":"$file_contents_ref"},{"name":"$combined_regex","localvar":"my","line":130,"kind":13,"containerName":"extract_bad_ips","definition":"my"},{"line":130,"name":"$regexes","containerName":"extract_bad_ips","kind":13},{"kind":13,"containerName":"extract_bad_ips","definition":"my","localvar":"my","name":"%bad_ips","line":133},{"localvar":"my","name":"$line","line":136,"containerName":"extract_bad_ips","kind":13,"definition":"my"},{"kind":13,"containerName":"extract_bad_ips","name":"@file_contents","line":136},{"kind":13,"containerName":"extract_bad_ips","line":137,"name":"$line"},{"line":138,"name":"$line","containerName":"extract_bad_ips","kind":13},{"name":"$bad_ips","line":139,"containerName":"extract_bad_ips","kind":13},{"name":"@unique_bad_ips","localvar":"my","line":143,"containerName":"extract_bad_ips","kind":13,"definition":"my"},{"containerName":"extract_bad_ips","kind":13,"name":"%bad_ips","line":143},{"name":"@unique_bad_ips","line":146,"containerName":"extract_bad_ips","kind":13}],"containerName":"NftablesBlocker::DefaultExtractor","name":"extract_bad_ips","range":{"start":{"line":110,"character":0},"end":{"line":147,"character":9999}}},{"name":"files","line":114,"kind":12},{"kind":12,"name":"regexes","line":115},{"definition":"sub","children":[{"name":"$args","localvar":"my","line":150,"containerName":"_ip_in_nftables","kind":13,"definition":"my"},{"line":151,"localvar":"my","name":"$table","definition":"my","kind":13,"containerName":"_ip_in_nftables"},{"line":151,"name":"$args","kind":13,"containerName":"_ip_in_nftables"},{"localvar":"my","name":"$element","line":152,"containerName":"_ip_in_nftables","kind":13,"definition":"my"},{"containerName":"_ip_in_nftables","kind":13,"name":"$args","line":152},{"definition":"my","containerName":"_ip_in_nftables","kind":13,"line":153,"name":"$ip","localvar":"my"},{"name":"$args","line":153,"containerName":"_ip_in_nftables","kind":13},{"localvar":"my","name":"$nftables","line":154,"kind":13,"containerName":"_ip_in_nftables","definition":"my"},{"containerName":"_ip_in_nftables","kind":13,"line":154,"name":"$args"},{"kind":13,"containerName":"_ip_in_nftables","line":154,"name":"$table"},{"name":"$element","line":154,"kind":13,"containerName":"_ip_in_nftables"},{"definition":"my","containerName":"_ip_in_nftables","kind":13,"line":156,"localvar":"my","name":"$nftable"},{"name":"$nftables","line":156,"kind":13,"containerName":"_ip_in_nftables"},{"kind":13,"containerName":"_ip_in_nftables","name":"$nftable","line":157},{"containerName":"_ip_in_nftables","kind":13,"name":"$nftable","line":158},{"containerName":"_ip_in_nftables","kind":13,"name":"$nftable","line":159},{"kind":13,"containerName":"_ip_in_nftables","line":159,"name":"$element"},{"containerName":"_ip_in_nftables","kind":13,"line":160,"name":"$nftable"},{"containerName":"_ip_in_nftables","kind":13,"line":160,"name":"$table"},{"containerName":"_ip_in_nftables","kind":13,"definition":"my","name":"$elements","localvar":"my","line":161},{"name":"$nftable","line":161,"containerName":"_ip_in_nftables","kind":13},{"definition":"my","kind":13,"containerName":"_ip_in_nftables","line":162,"localvar":"my","name":"$elem"},{"name":"$elements","line":162,"kind":13,"containerName":"_ip_in_nftables"},{"line":163,"name":"$actual_elem","localvar":"my","definition":"my","containerName":"_ip_in_nftables","kind":13},{"name":"$elem","line":163,"containerName":"_ip_in_nftables","kind":13},{"kind":13,"containerName":"_ip_in_nftables","line":164,"name":"$actual_elem"},{"kind":13,"containerName":"_ip_in_nftables","line":164,"name":"$ip"},{"definition":"my","kind":13,"containerName":"_ip_in_nftables","line":165,"name":"$expires","localvar":"my"},{"line":165,"name":"$actual_elem","containerName":"_ip_in_nftables","kind":13}],"containerName":"NftablesBlocker::DefaultExtractor","kind":12,"line":149,"range":{"end":{"character":9999,"line":174},"start":{"character":0,"line":149}},"name":"_ip_in_nftables"},{"line":151,"name":"table","kind":12},{"line":152,"name":"element","kind":12},{"kind":12,"name":"ip","line":153},{"kind":12,"line":154,"name":"nftables_set"},{"line":154,"name":"_get_nftables_to_json","kind":12},{"kind":12,"name":"table","line":154},{"name":"element","line":154,"kind":12},{"name":"set","line":157,"kind":12},{"name":"name","line":157,"kind":12},{"kind":12,"name":"set","line":158},{"name":"table","line":158,"kind":12},{"kind":12,"line":159,"name":"set"},{"name":"name","line":159,"kind":12},{"line":160,"name":"set","kind":12},{"kind":12,"line":160,"name":"table"},{"line":161,"name":"set","kind":12},{"kind":12,"line":161,"name":"elem"},{"line":163,"name":"elem","kind":12},{"line":164,"name":"val","kind":12},{"kind":12,"name":"expires","line":165},{"kind":12,"children":[{"line":177,"localvar":"my","name":"$args","definition":"my","containerName":"_get_nftables_to_json","kind":13},{"line":178,"localvar":"my","name":"$table","definition":"my","kind":13,"containerName":"_get_nftables_to_json"},{"name":"$args","line":178,"containerName":"_get_nftables_to_json","kind":13},{"kind":13,"containerName":"_get_nftables_to_json","definition":"my","name":"$element","localvar":"my","line":179},{"kind":13,"containerName":"_get_nftables_to_json","line":179,"name":"$args"},{"definition":"my","containerName":"_get_nftables_to_json","kind":13,"line":181,"name":"$cmd","localvar":"my"},{"localvar":"my","name":"$json_output","line":182,"containerName":"_get_nftables_to_json","kind":13,"definition":"my"},{"containerName":"_get_nftables_to_json","kind":13,"definition":"my","name":"$nft_data","localvar":"my","line":183},{"name":"$json_output","line":183,"kind":13,"containerName":"_get_nftables_to_json"},{"line":184,"localvar":"my","name":"$nftables","definition":"my","containerName":"_get_nftables_to_json","kind":13},{"containerName":"_get_nftables_to_json","kind":13,"line":184,"name":"$nft_data"},{"kind":13,"containerName":"_get_nftables_to_json","line":186,"name":"$nftables"}],"containerName":"NftablesBlocker::DefaultExtractor","definition":"sub","name":"_get_nftables_to_json","range":{"end":{"character":9999,"line":187},"start":{"line":176,"character":0}},"line":176},{"kind":12,"line":178,"name":"table"},{"kind":12,"name":"element","line":179},{"line":183,"name":"decode_json","kind":12},{"line":184,"name":"nftables","kind":12}]}